import math

def RK4_v(f, x0, y0, values):
    y = []
    h = 0
    for k in range(len(values)):
        if k == 0:
            h = abs(values[k] - x0)
        else:
            h = abs(values[k] - values[k - 1])
        m1 = f(x0, y0)
        m2 = f(x0 + h/2, y0 + (h/2)*m1)
        m3 = f(x0 + h/2, y0 + (h/2)*m2)
        m4 = f(x0 + h, y0 + h * m3)
        y0 += h * (m1 + 2 * m2 + 2 * m3 + m4) / 6
        x0 += h
        y.append(y0)
        # print(f"x_{k + 1}={x0} y_{k + 1}={y0}")
        # print(f"{y0},")
    return y

l = 0.02465
u =0.00513
r = 0.14141
def f(x, y):
    return (l - u) * y

def fn(x, y):
    return (l - u) * y + r*l*(f(x, y) - y)

def p(x, y):
    return r*l*(1 - y)

def exact(t):
    coef = 0.99835
    return 1 - coef*math.exp(-l*r*t)

x0 = 0 
y0 = 0.00165
t_values = [0.18893, 0.98338, 1.88914, 2.34575, 3.22604, 3.65212, 4.3269, 4.86726, 5.57331, 6.13957, 6.82557, 7.53422, 8.43528, 9.08612, 9.58516, 10.24973, 11.14712, 11.57736, 12.20714, 12.78002, 13.63959, 14.14857, 14.88472, 15.53353, 16.46705, 17.23509, 17.81219, 18.16708, 19.20707, 19.71624, 20.1892, 21.25185, 21.86127, 22.27583, 23.20308, 23.77689, 24.5795, 25.13453, 25.79872, 26.2962, 27.01799, 27.52647, 28.51913, 29.16714, 29.92391, 30.48337, 31.17173, 31.4082, 32.19453, 33.19135, 33.84628, 34.37726, 34.79249, 35.57141, 36.07659, 37.02824, 37.61146, 38.51559, 39.20838, 39.66769, 40.49882, 41.21666, 41.64812, 42.43787, 43.10568, 43.68644, 44.09858, 44.84453, 45.58632, 46.27637, 47.22054, 47.75547, 48.51518, 49.10378, 49.84628, 50.47785, 50.96716, 51.68435, 52.07141, 52.75184, 53.61331, 54.20941, 55.15074, 55.83098, 56.43215, 57.01034, 57.78763, 58.1613, 58.94973, 59.69983, 60.12224, 60.92494, 61.68335, 62.35668, 63.00646, 63.65235, 64.30835, 65.22285, 65.78357, 66.28078, 67.17687, 67.90412, 68.26894, 68.88361, 69.55788, 70.54792, 71.17245, 71.88893, 72.48093, 73.12717, 73.8053, 74.11613, 75.07702, 75.70014, 76.1552, 77.02954, 77.85844, 78.34563, 78.89657, 79.63179, 80.09465, 80.80416, 81.78391, 82.12548, 82.9697, 83.79451, 84.47796, 85.04315, 85.84991, 86.57617, 86.96433, 87.54788, 88.37372, 89.05258, 89.63072, 90.16765, 90.74992, 91.48935, 92.34657, 93.13246, 93.68415, 94.35548, 94.87279, 95.86774, 96.26556, 97.19429, 97.48312, 98.1646, 99.19913, 99.91925]
n = len(t_values)

pk = RK4_v(p, x0, y0, t_values)

for i in range(len(pk)):
    print(f"{pk[i]}, {abs(exact(t_values[i]) - pk[i])},")